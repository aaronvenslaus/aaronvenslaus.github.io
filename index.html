<html>
    <script src='https://d3js.org/d3.v5.min.js'></script>

<body onload='init()'>

    
        <svg width=900 height=900></svg>
       
    </div>

<script>
        async function init() {
       
        var data = await d3.csv("https://flunky.github.io/cars2017.csv");

        console.log(data);

        var electricVehicles = [];

        for( let idx = 0; idx < data.length; idx++)
        {
            let obj = data[idx];

            if(obj.Fuel == "Electricity")
            {
                electricVehicles.push(obj);
            }
        }

        console.log(electricVehicles);

        const svg = d3.select('svg');
        const svgContainer = d3.select('#container');

        const margin = 80;
        const width = 1000 - 2 * margin;
        const height = 600 - 2 * margin;
        
        
        const chart = svg.append('g')
            .attr('transform', `translate(${margin}, ${margin})`);

        

        const xScale = d3.scaleBand()
            .range([0, width])
            .domain(electricVehicles.map((electricVehicles) => electricVehicles.Make))
            .padding(0.2);

        const yScale = d3.scaleLinear()
           .domain([height, 0])
           .range([0, 100]);

        chart.append('g')
            .attr('transform', `translate(${width}, 0)`).call(d3.axisLeft(yScale));

        chart.append('g')
            .attr('transform', `translate(0, ${height})`)
            .call(d3.axisBottom(xScale));

        chart.selectAll()
            .data(electricVehicles)
            .enter()
            .append('rect')
            .attr('x', function(d) { return xScale(d.Make); })
            .attr('y', function(d) { return yScale(d.AverageHighwayMPG); })
            .attr('height', function(d) { return 125 - yScale(d.AverageHighwayMPG); })
            .attr('width', xScale.bandwidth())
        
        
        }
        
</script>

</body>
</html>