<html>
    <script src='https://d3js.org/d3.v5.min.js'></script>

<body onload='init()'>

    
        <svg></svg>
       
    </div>

<script>
        async function init() {
       
        var data = await d3.csv("https://flunky.github.io/cars2017.csv");

        console.log(data);

        var electricVehicles = [];

        for( let idx = 0; idx < data.length; idx++)
        {
            let obj = data[idx];

            if(obj.Fuel == "Electricity")
            {
                electricVehicles.push(obj);
            }
        }

        console.log(electricVehicles);

        const svg = d3.select('svg');

        const margin = 50;
        const width = 750;
        const height = 500 ;
        
        d3.select("svg").attr("width", width + 2 * margin).attr("height", height + 2 * margin)

        const chart = svg.append('g')
            .attr('transform', `translate(${margin}, ${margin})`);

        const xScale = d3.scaleBand()
            .range([0, width])
            .domain(electricVehicles.map((electricVehicles) => electricVehicles.Make))
            .padding(0.2);

        chart.append('g')
            .attr('transform', `translate(0, ${height})`)
            .call(d3.axisBottom(xScale));

        const yScale = d3.scaleLinear()
           .domain([0,125])
           .range([450, 0]);

        chart.append('g').attr('transform', `translate(0, ${margin})`).call(d3.axisLeft(yScale));

        // console.log(yScale(0))
        // console.log(yScale(50))
        // console.log(yScale(100))
        console.log(yScale(109))
        console.log(xScale('BMW'))


        chart.selectAll()
            .data(electricVehicles)
            .enter()
            .append('rect')
            .attr('x', function(d) { return xScale(d.Make); })
            .attr('y', function(d) { return 391; })
            .attr('height', function(d) { return yScale(d.AverageHighwayMPG); }) // 125 - yScale(
            .attr('width', xScale.bandwidth())
        
        
        }
        
</script>

</body>
</html>